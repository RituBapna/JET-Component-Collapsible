define(['./DvtToolkit'], function() {
  // Internal use only.  All APIs and functionality are subject to change at any time.
    // Map the D namespace to dvt, which is used to provide access across partitions.
  var D = dvt;
  D.kG=(0,D.w)();(0,D.sa)("DvtLegend",D.kG);D.D.l(D.kG,D.Rx,"DvtLegend");D.yy=function(b,c,d){var e=new D.kG;e.Init(b,c,d);return e};D.kG.newInstance=D.yy;D.kG.getDefaults=function(b){return(0,D.lG)(new D.mn,b)};D.C=D.kG.prototype;D.C.Init=function(b,c,d){D.kG.q.Init.call(this,b,c,d);this.setId("legend1000"+window.Math.floor(1E9*window.Math.random()));this.mf=new D.mn;this.sa=new D.Rm(this);this.sa.sf(this);this.yg=[];this.Ja=D.q;this.t4=[];this.Mg=new D.Pn};D.C.sJ=(0,D.B)("Mg");
D.C.be=function(b){b?this.N=this.mf.Vg(b):this.N||(this.N=(0,D.DC)(this))};D.C.Hz=function(b,c,d){this.be(b);this.za().isLayout=D.n;b=D.Zm.L(this,new D.H(0,0,c,d));this.za().isLayout=D.t;return b};D.C.L=function(b,c,d){this.be(b);this.za().isLayout=D.t;this.vi();this.yg=[];this.Ja=D.q;this.t4=[];!(0,D.wf)()&&"none"!=this.za().hideAndShowBehavior&&(0,D.yr)(this.sa,new D.wm(this.sa,this));return D.Zm.L(this,new D.H(0,0,c,d))};D.kG.prototype.render=D.kG.prototype.L;
D.kG.prototype.Rm=function(b){(0,D.FB)(b,this.yg)};D.kG.prototype.highlight=D.kG.prototype.Rm;D.kG.prototype.ag=function(b,c){var d=b.Ga();("categoryRollOver"==d||"categoryRollOut"==d)&&"dim"==this.za().hoverBehavior&&(0,D.Br)(b,this.yg);(this==c||"showPopup"==d||"hidePopup"==d)&&this.Xa(b)};D.kG.prototype.za=(0,D.B)("N");D.kG.prototype.Ua=(0,D.B)("sa");D.kG.prototype.U=function(){this.sa&&(this.sa.As(this),this.sa.U(),this.sa=D.q);D.kG.q.U.call(this)};D.kG.prototype.destroy=D.kG.prototype.U;
D.kG.prototype.xZ=(0,D.ca)("Ja");D.kG.prototype.Li=function(){return new D.ym(this)};D.kG.prototype.getAutomation=D.kG.prototype.Li;
D.Sm={};(0,D.sa)("DvtLegendConstants",D.Sm);D.D.l(D.Sm,D.D,"DvtLegendConstants");D.Sm.YD="background";D.Sm.BACKGROUND=D.Sm.YD;D.Sm.lE="legendItem";D.Sm.LEGEND_ITEM=D.Sm.lE;D.Sm.Kp="title";D.Sm.TITLE=D.Sm.Kp;
D.ym=function(b){this.Ba=b;this.Ic=this.Ba.za()};(0,D.sa)("DvtLegendAutomation",D.ym);D.D.l(D.ym,D.Ol,"DvtLegendAutomation");D.ym.prototype.hr=function(b){if((b=this.Ba.Ua().na(b))&&b instanceof D.zm)if(b=b.getData(),b=(0,D.Am)(this,b,this.Ic))return"section"+b;return D.q};
D.Am=function(b,c,d){if(d.sections&&0<d.sections.length){for(var e=0;e<d.sections.length;e++){if(d.sections[e]==c)return"["+e+"]";var f=(0,D.Am)(b,c,d.sections[e]);if(f)return"["+e+"]"+f}return D.q}if(d.items&&0<d.items.length){for(b=0;b<d.items.length;b++)if(d.items[b]==c)return":item["+b+"]";return D.q}};
D.Bm=function(b,c,d){if(d.sections&&0<d.sections.length){for(var e=0;e<d.sections.length;e++){var f=(0,D.Bm)(b,c,d.sections[e]);if(f)return"["+e+"]"+f}return D.q}if(d.items&&0<d.items.length){for(b=0;b<d.items.length;b++)if(d.items[b].text==c.name)return":item["+b+"]";return D.q}};
D.Cm=function(b,c,d){var e=d.indexOf("["),f=d.indexOf("]");if(0<=e&&0<=f){var e=d.substring(e+1,f),g=d.indexOf(":");d=d.substring(f+1);f=d.indexOf("]");return 0<=d.indexOf("[")&&0<=f?(0,D.Cm)(b,c.sections[e],d):0==g?c.items[e]:c.sections[e]}};D.ym.prototype.bk=function(b){b=(0,D.Cm)(this,this.Ic,b);for(var c=this.Ba.yg,d=0;d<c.length;d++){var e=c[d].getData();if(b==e)return c[d].ve()[0].oa()}return D.q};D.ym.prototype.getDomElementForSubId=D.ym.prototype.bk;D.ym.prototype.FH=function(){return this.Ic.title};
D.ym.prototype.getTitle=D.ym.prototype.FH;D.ym.prototype.getItem=function(b){for(var c,d=b.shift(),e=this.Ic;d!=D.k;)0<b.length?e=e.sections[d]:c=e.items[d],d=b.shift();return{text:c.text?c.text:D.q}};D.ym.prototype.getItem=D.ym.prototype.getItem;D.ym.prototype.wDa=function(b){for(var c,d=b.shift(),e=this.Ic;d!=D.k;)0<b.length?e=e.sections[d]:c=e.sections[d],d=b.shift();return{title:c.title?c.title:D.q,items:c.items?(0,D.Pm)(c.items):D.q,sections:c.sections?(0,D.Qm)(this,c.sections):D.q}};
D.ym.prototype.getSection=D.ym.prototype.wDa;D.Pm=function(b){for(var c=[],d=0;d<b.length;d++)c.push({text:b[d].text});return c};D.Qm=function(b,c){for(var d=[],e=0;e<c.length;e++)d.push({title:c[e].title?c[e].title:D.q,items:c[e].items?(0,D.Pm)(c[e].items):D.q,sections:c[e].sections?(0,D.Qm)(b,c[e].sections):D.q});return d};
D.mn=function(){this.Init({skyros:D.kn,alta:D.ln})};D.D.l(D.mn,D.Dl,"DvtLegendDefaults");D.ln={skin:"alta",textStyle:new D.M("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;"),titleStyle:new D.M("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 11px; color: #333333;"),colors:D.nn};
D.kn={skin:"skyros",orientation:"vertical",position:D.q,backgroundColor:D.q,borderColor:D.q,textStyle:new D.M("font-size: 11px; color: #333333;"),titleStyle:new D.M("font-size: 12px; color: #003d5b;"),titleHalign:"start",hideAndShowBehavior:"none",hoverBehavior:"none",scrolling:"asNeeded",halign:"center",valign:"middle",colors:D.on,markerShape:"square",lineWidth:3,layout:{gapRatio:1,outerGapWidth:3,outerGapHeight:3,titleGap:3,symbolGapWidth:5,symbolGapHeight:4,rowGap:0,columnGap:8,sectionGapHeight:6,
sectionGapWidth:15},isLayout:D.t};D.$m=function(b,c){return window.Math.ceil(c*b.layout.gapRatio)};
D.Rm=function(b){this.Init(b.e,b.ag,b);this.Ba=b};D.D.l(D.Rm,D.tm,"DvtLegendEventManager");D.C=D.Rm.prototype;D.C.Ns=function(b,c){var d=D.q;c instanceof D.Ll&&c.Tl()!=D.q?d=c.Tl():c instanceof D.zm&&(d=c.getId(),d={type:D.Sm.lE,id:d});this.gh(new D.Tm(b,d),this.Ba)};D.C.hh=function(b){D.Rm.q.hh.call(this,b);var c=this.na(b.target);if(c){var d=(0,D.xm)(this,c),c=(0,D.Um)(this,c);(d||c)&&b.stopPropagation()}};
D.C.xo=function(b){D.Rm.q.xo.call(this,b);var c=this.na(b.target);c&&(this.hz(c,D.n)&&b.stopPropagation(),this.Gx(c))};D.C.ok=function(b){D.Rm.q.ok.call(this,b);var c=this.na(b.target);c&&this.hz(c,D.t)&&b.stopPropagation()};D.C.Qu=function(b){var c=this.na(b.target);if(c){b=b.Nna;var d=(0,D.xm)(this,c),c=(0,D.Um)(this,c);(d||c)&&b&&b.preventDefault()}};D.C.PX=function(b){var c=this.na(b.target);this.hz(c,D.n)&&b.stopPropagation()};D.C.NX=function(b){var c=this.na(b.target);this.hz(c,D.t)&&b.stopPropagation()};
D.C.aP=function(b){var c=this.na(b.target);this.hz(c,D.n)&&b.stopPropagation()};D.C.OX=function(b){var c=this.na(b.target);this.hz(c,D.t)&&b.stopPropagation()};
D.xm=function(b,c){if("none"==b.Ba.za().hideAndShowBehavior)return D.t;var d=c.Oh?c.Oh():D.q;if(!d||0>=d.length)return D.t;for(var e=c.getData(),f=e.categoryVisibility,g=c.ve(),h=0;h<g.length;h++){var j=g[h];j instanceof D.Vm?j.mI(c.Hb()):j instanceof D.af&&c.Oj(j)}d=d[0];"hidden"==f?(e.categoryVisibility="visible",b.gh(new D.Wm(D.Wm.xE,d),b.Ba)):(e.categoryVisibility="hidden",b.gh(new D.Wm(D.Wm.Fx,d),b.Ba));return D.n};
D.Um=function(b,c){return c&&c.vj&&c.vj()?(b.gh(new D.Xm("action",c.vj(),c.getId()),b.Ba),D.n):D.t};D.Rm.prototype.hz=function(b,c){if("none"==this.Ba.za().hoverBehavior)return D.t;var d=b&&b.Oh?b.Oh():D.q;if(!d||0>=d.length)return D.t;this.gh(new D.Ym(c?"categoryRollOver":"categoryRollOut",d[0]),this.Ba);return D.n};
D.wm=function(b,c){this.Init(b,c)};D.D.l(D.wm,D.Zl,"DvtLegendKeyboardHandler");D.wm.prototype.Init=function(b,c){D.wm.q.Init.call(this,b);this.Ba=c};D.wm.prototype.$n=function(b){var c=b.keyCode,d=this.sa.Be();if(9==c){if(d)return b.preventDefault(),d;c=this.Ba.yg;if(0<c.length)return b.preventDefault(),this.ZM(c)}else if(13==c||32==c)d&&(0,D.xm)(this.Ba.Ua(),d);else return D.wm.q.$n.call(this,b)};
D.zm=function(b,c,d,e){this.Init(b,c,d,e)};D.D.l(D.zm,D.D,"DvtLegendObjPeer");D.C=D.zm.prototype;D.C.Init=function(b,c,d,e){this.Ba=b;this.Ge=c;this.zfa=d;this.Oa=d.id?d.id:d.text;this.uk=d.action;this.Nza=d._spb;this.ef=e;this.Wd=D.t;if(this.uk)for(b=0;b<this.Ge.length;b++)this.Ge[b].setCursor("pointer")};D.C.getData=(0,D.B)("zfa");D.C.Hb=function(){return this.zfa.color};D.C.getId=(0,D.B)("Oa");D.C.ve=(0,D.B)("Ge");D.C.Oh=function(){return[this.Oa]};D.C.ne=(0,D.B)("ef");D.C.vj=(0,D.B)("uk");
D.C.Ed=(0,D.B)("Nza");D.C.ee=function(){if("none"!=this.Ba.za().hideAndShowBehavior){var b=this.Ba.sJ(),c=[(0,D.wg)(b,"hidden"==this.getData().categoryVisibility?"STATE_HIDDEN":"STATE_VISIBLE")];return(0,D.en)(this.getData().text,c,b)}return D.q};D.C.Oj=function(b){(0,D.fn)()||(0,D.gn)(b,"label",this.ee())};D.C.Ef=function(b){return b.type==D.bi?this:(0,D.hn)(this,b,this.Ba.yg)};D.C.jf=function(b){return this.Ge[0]?this.Ge[0].C(b):new D.H(0,0,0,0)};
D.C.Pm=function(){return this.Ge[0]?this.Ge[0].oa():D.q};D.C.bg=function(){this.Wd=D.n;this.Ge[0]&&this.Ge[0].La((0,D.jn)())};D.C.Mc=function(){this.Wd=D.t;this.Ge[0]&&this.Ge[0].Z(D.q)};D.C.Gg=(0,D.B)("Wd");
D.Zm={};D.D.l(D.Zm,D.D,"DvtLegendRenderer");D.Zm.Ura=5;D.Zm.Vra=2;D.Zm.Sra=0.6;D.Zm.pba=10;
D.Zm.L=function(b,c){var d=b.za(),e=b.e,f="off"!=d.scrolling;d.isLayout||D.Zm.QL(b,c);var g=(0,D.$m)(d,d.layout.outerGapWidth),h=(0,D.$m)(d,d.layout.outerGapHeight);c.x+=g;c.y+=h;c.g-=2*g;c.j-=2*h;b.xZ(c);if(0>=c.g||0>=c.j)return new D.Ke(0,0);var j=f?new D.an(e,c):new D.R(e);b.k(j);var m=c.clone(),o=D.Zm.VL(b,j,d.title,m,D.q);m.y+=o.j;m.j-=window.Math.floor(o.j);m=D.Zm.mza(b,j,m);o=(0,D.$h)(o,m);o.j>c.j&&(f&&j.k8(o.j),o.j=c.j);if(d.isLayout)return new D.Ke(o.g+2*g,o.j+2*h);f=d.hAlign!=D.q?d.hAlign:
d.halign;"center"==f?j.F(c.x-o.x+(c.g-o.g)/2):"end"==f&&((0,D.I)(e)?j.F(c.x-o.x):j.F(c.x-o.x+c.g-o.g));d=d.vAlign!=D.q?d.vAlign:d.valign;"middle"==d?j.O(c.y-o.y+(c.j-o.j)/2):"bottom"==d&&j.O(c.y-o.y+c.j-o.j);j=b.t4;for(d=0;d<j.length;d++)e=j[d].ku(),"left"==e?j[d].da(o.x):"center"==e?j[d].da(o.x+o.g/2):"right"==e&&j[d].da(o.x+o.g);return new D.Ke(o.g+2*g,o.j+2*h)};
D.Zm.QL=function(b,c){var d=b.za(),e=d.backgroundColor,d=d.borderColor;if(e||d){var f=new D.af(b.e,c.x,c.y,c.g,c.j);e?f.la(e):(0,D.Yg)(f);d&&(f.La(d),(0,D.bn)(f));b.Ua().ja(f,new D.Ll(D.q,D.q,D.q,{type:D.Sm.YD,id:D.k}));b.k(f)}};
D.Zm.VL=function(b,c,d,e,f,g){var h=b.za(),j=(0,D.I)(c.e);if(!d)return new D.H(j?e.x+e.g:e.x,e.y,0,0);d=new D.ph(c.e,d,j?e.x+e.g:e.x,e.y);var m=f&&f.titleStyle?new D.M(f.titleStyle):h.titleStyle;d.Ha(m);return D.Kl.Ub(d,e.g,e.j,c)?(b.Ua().ja(d,new D.Ll(d.Aq,D.q,D.q,{type:D.Sm.Kp,id:D.k})),j&&d.ni(),e=d.Rb(),m=(0,D.$m)(h,h.layout.titleGap),h.isLayout?c.removeChild(d):g||(c=f&&f.titleHalign?f.titleHalign:h.titleHalign,"center"==c?d.Re():"end"==c&&(j?d.Sk():d.ni()),b.t4.push(d)),e.j+=m,e):new D.H(j?
e.x+e.g:e.x,e.y,0,0)};
D.Zm.mza=function(b,c,d){var e=b.za();e.symbolWidth==D.q&&e.symbolHeight==D.q?(e.symbolWidth=D.Zm.pba,e.symbolHeight=D.Zm.pba):e.symbolWidth==D.q?e.symbolWidth=e.symbolHeight:e.symbolHeight==D.q&&(e.symbolHeight=e.symbolWidth);var f=(0,D.$m)(e,e.layout.sectionGapHeight),g=(0,D.$m)(e,e.layout.sectionGapWidth),h=D.Zm.nwa(b),j="vertical"!=e.orientation,m=e.sections,o=D.q,p=d.clone(),r;for(window.i=0;window.i<m.length;window.i++)j?(r=D.Zm.iia(b,c,m[window.i],p,h),r.g>p.g?(p.g<d.g&&(d.y+=r.j+f,d.j-=r.j+
f),r=r.g<=d.g?D.Zm.iia(b,c,m[window.i],d,h):D.Zm.oia(b,c,m[window.i],d,h,D.t),d.y+=r.j+f,d.j-=r.j+f,p=d.clone()):(p.g-=r.g+g,(0,D.I)(b.e)||(p.x+=r.g+g))):(r=D.Zm.oia(b,c,m[window.i],d,h,"off"!=e.scrolling),d.y+=r.j+f,d.j-=r.j+f),o=o?(0,D.$h)(o,r):r;return o};
D.Zm.oia=function(b,c,d,e,f,g){if(d){var h=b.za(),j=(0,D.$m)(h,h.layout.symbolGapWidth),m=(0,D.$m)(h,h.layout.rowGap),o=(0,D.$m)(h,h.layout.columnGap),p=(0,D.I)(b.e),r=e.clone();g&&(r.j=window.Infinity);var u=D.Zm.VL(b,c,d.title,r,d);if(!d.items)return u;r.y+=u.j;r.j-=u.j;var v=r.y,z=D.Zm.sua(b,r,f,d.items,g);g=z.numCols;var A=z.numRows,z=z.width,F=A*(f+m)-m,E=window.Math.min(g*(z+o)-o,r.g),u=new D.H(p?e.x+e.g-window.Math.max(E,u.g):e.x,e.y,window.Math.max(E,u.g),F+u.j);if(h.isLayout)return u;if(0==
A||0==g)return new D.H(p?e.x+e.g:e.x,e.y,0,0);e=z-h.symbolWidth-j;h=0;j=1;F=d.items.length;for(E=0;E<F;E++)D.Zm.iK(b,c,d.items[E],r,e,f,E),r.y+=f+m,h++,h===A&&j!==g&&(r.y=v,r.g-=z+o,p||(r.x+=z+o),h=0,j++);return u}};
D.Zm.iia=function(b,c,d,e,f){if(d){var g=b.za(),h=g.symbolWidth,j=(0,D.$m)(g,g.layout.symbolGapWidth),m=(0,D.$m)(g,g.layout.columnGap),o=d.items.length,p=(0,D.I)(b.e),r=e.clone(),u=D.Zm.VL(b,c,d.title,e,d,D.n);if(d.items)0<u.g&&(r.g-=u.g+m,p||(r.x+=u.g+m));else return u;var v=[],z=e.g-r.g,A,F;for(F=0;F<o;F++)A=d.items[F],A=window.Math.ceil(D.Zm.Jea(b,A.text)),z+=A+h+j+m,v.push(A);0<o&&(z-=m);u=new D.H(p?e.x+e.g-z:e.x,e.y,z,window.Math.max(f,u.j));if(g.isLayout||z>e.g)return u;for(F=0;F<o;F++)A=d.items[F],
D.Zm.iK(b,c,A,r,v[F],f,F),e=v[F]+h+j,r.g-=e+m,p||(r.x+=e+m);return u}};
D.Zm.sua=function(b,c,d,e,f){for(var g=b.za(),h=0,j=0;j<e.length;j++){var m=D.Zm.Jea(b,e[j].text);m>h&&(h=m)}b=g.symbolWidth;m=(0,D.$m)(g,g.layout.rowGap);j=(0,D.$m)(g,g.layout.columnGap);g=window.Math.ceil(b+(0,D.$m)(g,g.layout.symbolGapWidth)+h);f?(f=1,d=e.length):(d=window.Math.min(window.Math.floor((c.j+m)/(d+m)),e.length),f=window.Math.ceil(e.length/d),d=window.Math.ceil(e.length/f));c=window.Math.min(g,(c.g-j*(f-1))/f);return c<b?{width:0,numCols:0,numRows:0}:{width:c,numCols:f,numRows:d}};
D.Zm.nwa=function(b){var c=b.za();b=new D.ph(b.e,"Test");b.Ha(c.textStyle);b.Ae();b=D.Kl.Qi(b).j;return window.Math.ceil(window.Math.max(b,c.symbolHeight+(0,D.$m)(c,c.layout.symbolGapHeight)))};D.Zm.Jea=function(b,c){var d=b.za(),e=new D.ph(b.e,c);e.Ha(d.textStyle);return e.Rb().g};
D.Zm.iK=function(b,c,d,e,f,g,h){var j=b.za(),m=b.e,o=(0,D.I)(m),p=j.symbolWidth,r=(0,D.$m)(j,j.layout.symbolGapWidth),u=(0,D.$m)(j,j.layout.columnGap),v=o?e.x+e.g-p:e.x,z=o?e.x+e.g-p-r:e.x+p+r;h=D.Zm.Sua(b,v,e.y,g,d,h);var A=d.text,F;if(A&&(F=D.Zm.Tua(c,f,A,j.textStyle)))F.da(z),F.ta(e.y+g/2),o&&F.ni();c.k(h);e=new D.af(m,o?z-f-u/2:v-u/2,e.y,p+r+f+u,g);(0,D.Yg)(e);c.k(e);c=[e,h,F];if(!c||!d)F=D.q;else{F=new D.zm(b,c,d,F!=D.q?F.Aq:D.q);b.yg.push(F);for(f=0;f<c.length;f++)b.Ua().ja(c[f],F)}"hidden"==
d.categoryVisibility&&F&&h.mI(F.Hb());"none"!=b.za().hideAndShowBehavior&&(e.If("img"),F.Oj(e))};D.Zm.Tua=function(b,c,d,e){d=new D.ph(b.e,d);d.Ae();d.Ha(e);return d=D.Kl.Ub(d,c,window.Infinity,b)?d:D.q};
D.Zm.Sua=function(b,c,d,e,f,g){var h=b.za();f.markerShape||(f.markerShape=h.markerShape);if(!f.color){var j=h.colors;f.color=j[g%j.length]}f.lineWidth||(f.lineWidth=h.lineWidth);g=h.symbolWidth;h=window.Math.min(g,h.symbolHeight);j=f.type!=D.q?f.type:f.symbolType;"line"==j?(f.lineWidth=window.Math.min(f.lineWidth,D.Zm.Ura),j=D.Zm.lda(b.e,c,d,g,e,f)):"lineWithMarker"==j?(f.lineWidth=window.Math.min(f.lineWidth,D.Zm.Vra),j=D.Zm.lda(b.e,c,d,g,e,f),"hidden"!=f.categoryVisibility&&j.k(D.Zm.nda(b,c,d,g,
e,h*D.Zm.Sra,f))):j=D.Zm.nda(b,c,d,g,e,h,f);return j};D.Zm.nda=function(b,c,d,e,f,g,h){var j=b.e,m=b.za();b=h.markerShape;var o=h.markerColor?h.markerColor:h.color,p=h.pattern;d+=(f-g)/2;c+=(e-g)/2;p?(g=new D.Vm(j,b,m.skin,0,0,g,g),g.H(new D.nm(p,o,"#FFFFFF")),(0,D.jg)(g,c,d)):(g=new D.Vm(j,b,m.skin,c,d,g,g),g.la(o));h.borderColor&&g.La(h.borderColor,D.q,h._borderWidth?h._borderWidth:1);"square"==b&&(0,D.bn)(g);return g};
D.Zm.lda=function(b,c,d,e,f,g){d+=f/2;b=new D.cn(b,c,d,c+e,d);c=new D.ff(g.color,1,g.lineWidth);g=g.lineStyle;"dashed"==g?c.$i((0,D.dn)(g),"4,2,4"):"dotted"==g&&c.$i((0,D.dn)(g),"2");b.Z(c);(0,D.bn)(b);return b};
});