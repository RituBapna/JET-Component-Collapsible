/*
 Copyright (c) 2014, Oracle and/or its affiliates.
 All rights reserved.
*/
define(["ojs/ojcore","jquery","ojs/ojcomponentcore","ojs/ojmodel","ojs/ojdatacollection-common"],function(a,f){a.Ia("oj.ojRowExpander",f.oj.baseComponent,{version:"1.0.0",widgetEventPrefix:"oj",options:{context:null,expand:null,collapse:null},ke:{root:"oj-rowexpander",icon:"oj-component-icon",clickable:"oj-clickable-icon-nocontext",expand:"oj-rowexpander-expand-icon",collapse:"oj-rowexpander-collapse-icon",leaf:"oj-rowexpander-leaf-icon",lazyload:"oj-rowexpander-lazyload-icon",toucharea:"oj-rowexpander-touch-area",
indent:"oj-rowexpander-indent",iconspacer:"oj-rowexpander-icon-spacer",depth0:"oj-rowexpander-depth-0",depth1:"oj-rowexpander-depth-1",depth2:"oj-rowexpander-depth-2",depth3:"oj-rowexpander-depth-3",depth4:"oj-rowexpander-depth-4",depth5:"oj-rowexpander-depth-5",depth6:"oj-rowexpander-depth-6",depth7:"oj-rowexpander-depth-7"},ll:{Vl:7,uJ:53},_create:function(){this._super();this.element.addClass(this.ke.root)},_init:function(){var a=this,b;this._super();b=this.options.context;this.ta=b.component;
this.fc=b.datasource;this.depth=b.depth;this.xg=b.state;this.Oi=b.key;this.index=b.index;this.js=b.parentKey;this.ML();this.KL();this.kr();if("expanded"===this.xg||"collapsed"===this.xg)f(this.RI).on("click",function(b){b.preventDefault();a.MB()}),f(this.element).on("keypress",function(b){if((b.keyCode||b.which)===f.ui.keyCode.ENTER||f.ui.keyCode.SPACE)a.MB(),b.preventDefault(),b.target.focus()}),null!=this.ta&&(this.RH=this.NP.bind(this),f(this.ta.element).on("ojkeydown",this.RH)),null!=this.fc&&
(this.QH=this.IP.bind(this),this.PH=this.AP.bind(this),this.fc.on("expand",this.QH,this),this.fc.on("collapse",this.PH,this));null!=this.ta&&(this.OH=this.zP.bind(this),f(this.ta.element).on("ojactive",this.OH))},refresh:function(){this.element.empty();this._init()},_destroy:function(){null!=this.ta&&(f(this.ta.element).off("ojkeydown",this.RH),f(this.ta.element).off("ojactive",this.OH));null!=this.fc&&(this.fc.off("expand",this.QH,this),this.fc.off("collapse",this.PH,this));this.removeClass(this.ke.root);
this.element.empty()},ML:function(){var a,b,d;d=this.depth-1;if(d<this.ll.Vl)a=f(document.createElement("span")).addClass(this.ke.indent).addClass(this.ke["depth"+d]),this.element.append(a);else{for(b=1;b<=d/this.ll.Vl;b++)a=f(document.createElement("span")).addClass(this.ke.indent).addClass(this.ke["depth"+this.ll.Vl]),this.element.append(a);a=d%this.ll.Vl;a<this.ll.Vl&&(a=f(document.createElement("span")).addClass(this.ke.indent).addClass(this.ke["depth"+a]),this.element.append(a))}},KL:function(){var a=
f(document.createElement("div")).addClass(this.ke.iconspacer);this.RI=f(document.createElement("div")).addClass(this.ke.toucharea);this.icon=f(document.createElement("a")).attr("href","#").addClass(this.ke.icon).addClass(this.ke.clickable);this.element.append(a.append(this.RI.append(this.icon)))},$i:function(a){this.icon.addClass(this.ke[a])},Dj:function(a){this.icon.removeClass(this.ke[a])},kr:function(){switch(this.xg){case "leaf":this.Dj("icon");this.Dj("clickable");this.$i("leaf");break;case "collapsed":this.$i("expand");
this.zp(!1);break;case "expanded":this.$i("collapse");this.zp(!0);break;case "loading":this.Dj("clickable"),this.$i("lazyload")}},kw:function(){switch(this.xg){case "leaf":this.Dj("leaf");this.$i("icon");this.$i("clickable");break;case "collapsed":this.Dj("expand");break;case "expanded":this.Dj("collapse");break;case "loading":this.Dj("lazyload"),this.$i("clickable")}},zP:function(a,b){var d,e;null!=b.activeKey&&(d=b.activeKey.rowKey,this.Oi!==d||null!=b.previousActiveKey&&b.previousActiveKey.row==
b.activeKey.row||!this.ta.gr||(d=this.N("accessibleRowDescription",{level:this.depth,num:this.index+1,total:this.fc.getWrappedDataSource().Je(this.js)}),e="collapsed"===this.xg?this.N("accessibleStateCollapsed"):"expanded"===this.xg?this.N("accessibleStateExpanded"):"",this.ta.gr({context:d,state:e})))},NP:function(c,b){var d;this.Oi===b.rowKey&&(d=c.keyCode||c.which,a.fa.Ex(c)&&(d==f.ui.keyCode.RIGHT?(this.Iv(),this.fc.expand(this.Oi)):d==f.ui.keyCode.LEFT?(this.Iv(),this.fc.collapse(this.Oi)):c.altKey&&
d==this.ll.uJ&&this.ta.gr&&(d=this.N("accessibleRowDescription",{level:this.depth,num:this.index+1,total:this.fc.getWrappedDataSource().Je(this.js)}),this.ta.gr({context:d,state:""}))))},Iv:function(){this.kw();this.xg="loading";this.kr()},IP:function(a){a=a.rowKey;a===this.Oi&&(this.kw(),this.xg="expanded",this.kr(),this.zp(!0),this._trigger("expand",null,{rowKey:a}))},AP:function(a){a=a.rowKey;a===this.Oi&&(this.kw(),this.xg="collapsed",this.kr(),this.zp(!1),this._trigger("collapse",null,{rowKey:a}))},
MB:function(){var a=this.xg;this.Iv();"collapsed"===a?this.fc.expand(this.Oi):"expanded"===a&&this.fc.collapse(this.Oi)},zp:function(a){this.icon.attr("aria-expanded",a)},getNodeBySubId:function(a){return null==a?this.element?this.element[0]:null:"oj-rowexpander-icon"===a.subId?this.icon:null}})});
//# sourceMappingURL=oj-modular.map