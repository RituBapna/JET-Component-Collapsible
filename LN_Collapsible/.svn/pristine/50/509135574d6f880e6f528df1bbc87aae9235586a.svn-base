define(["ojs/ojcore","jquery","ojs/ojcomponentcore"],function(a,f){(function(){var c="oj-left oj-center oj-right oj-top oj-middle oj-bottom".split(" "),b={"right-top":"oj-right oj-top","right-middle":"oj-right oj-middle","right-bottom":"oj-right oj-bottom","left-top":"oj-left oj-top","left-middle":"oj-left oj-middle","left-bottom":"oj-left oj-bottom","center-top":"oj-center oj-top","center-middle":"oj-left oj-middle","center-bottom":"oj-center oj-bottom"};a.Ia("oj.ojPopup",f.oj.baseComponent,{widgetEventPrefix:"oj",
options:{autoDismiss:"focusLoss",chrome:"default",initialFocus:"none",position:{my:"start top",at:"start bottom",of:"",collision:"flip"},tail:"none",beforeOpen:null,open:null,beforeClose:null,close:null,focus:null},_ComponentCreate:function(){this._super();var a=f("\x3cdiv\x3e");this.md=a.hide().addClass("oj-popup").attr("aria-hidden","true");a.addClass("oj-helper-reset-inheritable oj-component");var b=f("\x3cdiv\x3e").addClass("oj-popup-content");b.appendTo(a);this.element.after(a);this.element.appendTo(b);
this.element.show();this.bB();this.rF();this.cN();this.tG=f.proxy(this.fU,this)},_destroy:function(){this._super();this.isOpen()&&this.close();this.uB();this.KN();delete this.tG;this.md.replaceWith(this.element);this.element.hide()},widget:function(){return this.md},open:function(b,c){if(this.isOpen()&&(this.close(),this.isOpen()))return;this.oT(b);var g=this.md;b=this.Kb;a.i.jb(g,jQuery);a.i.jb(b,jQuery);a.fb.YH(g.attr("id"))&&g.uniqueId();if(!1!==this._trigger("beforeOpen")){this.DF(c);var h=this.options;
this.ow(h.autoDismiss);this._on(!0,f(window),{resize:this.rh,scroll:this.rh});this._on(!0,g,{keydown:this.vD});this._on(!0,b,{keydown:this.vD});this.JL();g.removeAttr("aria-hidden");g.attr("role","tooltip");c=h.position;g.show();var k="rtl"===this.Ec();g.position(a.de.Dg(c,k));this._trigger("open");this.fD();g=this.N("none"===h.initialFocus?"ariaLiveRegionInitialFocusNone":"ariaLiveRegionInitialFocusFirstFocusable");this.kA(g)}},close:function(){if(this.isOpen()&&!1!==this._trigger("beforeClose")){this.RS();
var b=this.Kb,c=this.md;a.i.jb(c,jQuery);a.i.jb(b,jQuery);c.hide();c.attr("aria-hidden","true");this.BS();this.ow();var g=f(window);this._off(g,"resize");this._off(g,"scroll");this._off(c,"keydown");this._off(b,"keydown");delete this.Kb;b=this.options.position;b._ofo&&(delete b._ofo,delete b.of);this.kA(null);this._trigger("close")}},isOpen:function(){return this.md.is(":visible")},_setOption:function(a,b){var c=this.options;switch(a){case "tail":b!==c.tail&&this.tT(b);break;case "chrome":b!==c.chrome&&
this.rF(b);break;case "position":this.DF(b);this.isOpen()&&this.rh();return;case "autoDismiss":this.isOpen()&&b!==c.autoDismiss&&this.ow(b)}this._superApply(arguments)},rX:function(){return"oj-popup"},tT:function(a){this.uB();this.bB(a);this.rh()},bB:function(b){b=b?b:this.options.tail;if("none"!==b){b=["oj-popup-tail",b].join("-");var c=f("\x3cdiv\x3e").hide().addClass("oj-popup-tail").addClass(b);this.ZF="#"+c.uniqueId().attr("id");var g=this.md;a.i.jb(g,jQuery);c.appendTo(g);g.addClass(b)}},DC:function(){var a=
this.ZF;return a?f(a):null},uB:function(){var b=this.DC();b&&b.remove();delete this.ZF;var b=["oj-popup-tail",this.options.tail].join("-"),c=this.md;a.i.jb(c,jQuery);c.removeClass(b)},rF:function(b){b=b?b:this.options.chrome;var c=this.md;a.i.jb(c,jQuery);"default"===b&&c.hasClass("oj-popup-no-chrome")?c.removeClass("oj-popup-no-chrome"):"none"!==b||c.hasClass("oj-popup-no-chrome")||c.addClass("oj-popup-no-chrome")},oT:function(b){b?"string"===f.type(b)?b=f(b):1===b.nodeType&&(b=f(b)):b=f(document.activeElement);
if(b instanceof jQuery&&1<b.length){var c=this.md;a.i.jb(c,jQuery);for(var g=0;g<b.length;g++){var h=b[0];if(!a.fa.mo(c[0],h)){b=f(h);break}}}else if(!(b instanceof jQuery)||b instanceof jQuery&&0===b.length)b=f(document.activeElement);a.i.jb(b,jQuery);this.Kb=b},DF:function(b){var c=this.options;b&&(c.position=f.extend(c[b],b));b=c.position;c=this.tG;a.i.pi(c);f.isFunction(b.using)&&b.using!==c&&(b.origUsing=b.using);b.using=c;c=this.Kb;a.i.jb(c,jQuery);b.of||(b.of=c,b._ofo=!0)},fU:function(d,e){var f=
e.element.element;a.i.jb(f,jQuery);var h=this.DC();if(h){h.hide();for(var k=0;k<c.length;k++)h.removeClass(c[k]),f.removeClass(c[k]);h.removeAttr("style");k=b[[e.horizontal,e.vertical].join("-")];a.i.Dr(k);h.addClass(k);f.addClass(k);h.show();"left"===e.horizontal||"right"===e.horizontal?(k=(h.outerWidth()-1)*("left"===e.horizontal?1:-1),d.left+=k):"center"===e.horizontal&&(k=(h.outerHeight()-1)*("top"===e.vertical?1:-1),d.top+=k);f.css(d);"middle"===e.vertical?(f=f.height(),f=Math.round((f/2-h.outerHeight()/
2)/f*100),h.css({top:f+"%"})):"center"===e.horizontal&&(f=f.width(),f=Math.round((f/2-h.outerWidth()/2)/f*100),h.css({left:f+"%"}));(h=this.options.position.origUsing)&&h(d,e)}else f.css(d)},rh:function(){var b=this.md;a.i.jb(b,jQuery);var c=this.options.position;a.i.je(c);var f="rtl"===this.Ec();b.position(a.de.Dg(c,f))},fD:function(b){var c=this.options;if(b||"none"!==c.initialFocus)if(b||"firstFocusable"===c.initialFocus)b=this.element.find(":focusable"),0<b.length?(b=b[0],a.i.hf(b),f(b).focus()):
(b=this.md,a.i.jb(b,jQuery),b.attr("tabindex","-1"),b.focus()),this._trigger("focus")},Av:function(b){b||(b=document.activeElement);a.i.hf(b);if(!b)return!1;var c=this.md;a.i.jb(c,jQuery);return a.fa.mo(c[0],b)},OQ:function(b){b||(b=document.activeElement);a.i.hf(b);var c=this.Kb;a.i.jb(c,jQuery);return a.fa.mo(c[0],b)},RS:function(){if(this.Av()){var b=this.Kb;a.i.jb(b,jQuery);b.focus()}},vD:function(b){if(!b.isDefaultPrevented()){var c=b.target;a.i.hf(c);if(27===b.keyCode)b.preventDefault(),this.close();
else if(117===b.keyCode)this.Av(c)?(b.preventDefault(),b=this.Kb,a.i.jb(b,jQuery),b.focus()):this.OQ(c)&&(b.preventDefault(),this.fD(!0));else if(9===b.keyCode&&this.Av(c)){var g=this.element.find(":tabbable");if(0<g.length){var h=g[0];a.i.hf(h);g=g[g.length-1];a.i.hf(g);h===c&&b.shiftKey?(b.preventDefault(),f(g).focus()):g!==c||b.shiftKey||(b.preventDefault(),f(h).focus())}else b.preventDefault(),b=this.Kb,a.i.jb(b,jQuery),b.focus()}}},ow:function(a){var b=document.documentElement,c=this.QB;c&&(b.removeEventListener("mousedown",
c,!0),b.removeEventListener("focus",c,!0),delete this.QB);"focusLoss"===a&&(c=this.QB=f.proxy(this.NN,this),b.addEventListener("mousedown",c,!0),b.addEventListener("focus",c,!0))},NN:function(b){var c=this.Kb,f=this.md;a.i.jb(c,jQuery);a.i.jb(f,jQuery);b=b.target;a.i.hf(b);a.fa.mo(c[0],b)||a.fa.mo(f[0],b)||this.close()},JL:function(){var b=this.Kb,c=this.md;a.i.jb(b,jQuery);a.i.jb(c,jQuery);var c=c.attr("id"),g=b.attr("aria-describedby"),g=g?g.split(/\s+/):[];g.push(c);g=f.trim(g.join(" "));b.attr("aria-describedby",
g)},BS:function(){var b=this.Kb,c=this.md;a.i.jb(b,jQuery);a.i.jb(c,jQuery);var c=c.attr("id"),g=b.attr("aria-describedby"),g=g?g.split(/\s+/):[],c=f.inArray(c,g);-1!==c&&g.splice(c,1);(g=f.trim(g.join(" ")))?b.attr("aria-describedby",g):b.removeAttr("aria-describedby")},cN:function(){var b=this.md;a.i.jb(b,jQuery);var c=this.sP("ariaLive"),g=this.Gv=f("\x3cdiv\x3e");g.attr({id:c,role:"log","aria-live":"polite","aria-relevant":"additions"});g.addClass("oj-helper-hidden-accessible");g.appendTo(document.body);
b.data("oj-aria-controls",c)},kA:function(b){var c=this.Gv;a.i.jb(c,jQuery);c.children().remove();a.fb.isEmpty(b)||f("\x3cdiv\x3e").text(b).appendTo(c)},KN:function(){var b=this.Gv;a.i.jb(b,jQuery);b.remove();delete this.Gv;b=this.md;a.i.jb(b,jQuery);b.removeData("oj-aria-controls")},sP:function(a){return this.uuid+"_"+a}})})()});
//# sourceMappingURL=oj-modular.map