/*
 Copyright (c) 2014, Oracle and/or its affiliates.
 All rights reserved.
 Copyright 2013 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
define(["ojs/ojcore","jquery","ojs/ojcomponentcore","ojs/ojconveyorbelt"],function(a,f){(function(){var c={cut:"ojtabscut","paste-before":"ojtabspastebefore","paste-after":"ojtabspasteafter"};a.Ia("oj.ojTabs",f.oj.baseComponent,{widgetEventPrefix:"oj",delay:300,options:{selected:0,disabledTabs:null,truncation:"auto",selectOn:"click",orientation:"horizontal",removable:!1,removeCueText:"Removable",reorderable:!1,beforeSelect:null,select:null,beforeDeselect:null,deselect:null,beforeRemove:null,remove:null,
optionChange:null},_ComponentCreate:function(){var a=this.options;this._super();this.by=!1;this.GF(a.orientation);this.BF(a.disabledTabs);this.oE();this.vr();var c=a.selected;a.selected=void 0;this.Va={};this.Va.te=!1;this.Va.ue=!1;this.Va.Pl=!1;this.Va.Po=!1;this.en();this.um();this.Tb();c=this.oC(c);void 0===c&&(c=this.cn(0));a.selected=c},_init:function(){this.NB(this.options.selected)},NB:function(a){this.jn(a)&&(a=this.mC(a),a=void 0===a?void 0:this.cn(a));this.sp(a)},_OpenContextMenu:function(a,
c){a.open(c,{launcher:this.Uf.children("[tabindex\x3d0]"),initialFocus:"menu"})},HT:function(a){var c=f(this.document[0].activeElement).closest("li"),e=this.Fb.index(c),g=!0;if(!this.MC(a)){switch(a.keyCode){case f.ui.keyCode.RIGHT:case f.ui.keyCode.DOWN:e++;break;case f.ui.keyCode.UP:case f.ui.keyCode.LEFT:g=!1;e--;break;case f.ui.keyCode.END:e=this.Fb.length-1;break;case f.ui.keyCode.HOME:e=0;break;case 46:if(c=this.ka.find(".oj-tabs-close-icon"))a.preventDefault(),this.VE({target:c,currentTarget:c,
preventDefault:f.noop});return;default:return}a.preventDefault();clearTimeout(this.kU);var h=this.xu(e,g);a.ctrlKey||(c.attr("aria-selected","false"),this.Hk(h).attr("aria-selected","true"),this.kU=this._delay(function(){this.option("selected",h)},this.delay))}},LR:function(a){!this.MC(a)&&a.ctrlKey&&a.keyCode===f.ui.keyCode.UP&&(a.preventDefault(),this.ka.focus())},MC:function(a){var c=this.vj(this.options.selected);if(a.ctrlKey&&a.keyCode===f.ui.keyCode.PAGE_UP)return this.sp(this.xu(c-1,!1)),!0;
if(a.ctrlKey&&a.keyCode===f.ui.keyCode.PAGE_DOWN)return this.sp(this.xu(c+1,!0)),!0},jn:function(a){return 0<=a&&a<this.Fb.length?f(this.Fb[a]).hasClass("oj-disabled"):!1},pO:function(a,c){function e(){a>f&&(a=0);0>a&&(a=f);return a}for(var f=this.Fb.length-1;this.jn(e());)a=c?a+1:a-1;return a},xu:function(a,c){a=this.pO(a,c);this.tq(a).focus();return this.cn(a)},mC:function(a){a=this.vj(a);for(var c=a+1,e=this.Fb.length-1;c<=e;){if(!this.jn(c))return c;c++}for(c=a-1;0<=c;){if(!this.jn(c))return c;
c--}},_setOption:function(a,c,e){"selected"===a?(c=this.oC(c),void 0!==c&&this.sp(c)):"disabledTabs"===a?Array.isArray(c)&&(this.BF(c),this.refresh(),this.vr()):"removable"===a?this.rT(c):"reorderable"===a?c!==this.options.reorderable&&(this.options.reorderable=c,this.HF(),this.refresh()):"orientation"===a?(this.GF(c),this.refresh()):"truncation"===a?(this.options.truncation=c,this.refresh()):("contextMenu"===a&&(this.Lp(),c&&this.en(c)),this._super(a,c,e),"selectOn"===a&&(this.Ln(),this._super(a,
c),this.Gj()))},refresh:function(){this._super();this.JN();this.oE();this.Tb()},Tb:function(){var a=this.options,c=this.element.children(".oj-tabs-selected");this.ka=c.length?this.Hk(c.attr("id")):f();this.ZM();this.Ln();this.Gj();this.Fb.not(this.ka).attr({"aria-selected":"false",tabIndex:"-1"});this.Sc.not(this.Yh(this.ka)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});this.ka.length?(this.ka.addClass("oj-selected").attr({"aria-selected":"true",tabIndex:"0"}),c.show().attr({"aria-expanded":"true",
"aria-hidden":"false"})):this.tq(0).attr("tabIndex","0");void 0!==this.tp&&(this.NB(this.tp),this.tp=void 0);"horizontal"==a.orientation?(this.RT(),this.IL(),void 0===this.options.selected||0==this.vj(this.options.selected)?this.element.addClass("oj-first-child-selected"):this.element.removeClass("oj-first-child-selected")):this.element.removeClass("oj-first-child-selected");this.HF()},IL:function(){var a=this.Uf.uniqueId().attr("id");this.si=this.BC().parent().ojConveyorBelt({orientation:"horizontal",
contentParent:"#"+a})},oE:function(){var a=this;this.tB();this.Uf=f("\x3cul\x3e").addClass("oj-tabs-nav oj-helper-clearfix").attr("role","tablist").prependTo(this.element);this.Fb=f();this.Sc=f();this.Lo=f();this.element.children(":not(.oj-tabs-nav)").each(function(){var c=f(this).find("\x3e :first-child"),e=c.clone();e.addClass("oj-tabs-title").css({display:""}).attr({"aria-hidden":"false"});a.Lo=a.Lo.add(e);var g=e.wrap("\x3cli\x3e\x3cdiv\x3e\x3ca href\x3d'#'\x3e\x3c/a\x3e\x3c/div\x3e\x3c/li\x3e").parent();
g.addClass("oj-tabs-anchor").attr({role:"presentation",tabIndex:"-1"});var h=g.parent().addClass("oj-tabs-tab-content").parent().addClass("oj-tabs-tab").attr({role:"tab","aria-hidden":"false",tabIndex:"-1"});h.appendTo(a.Uf);a.Fb=a.Fb.add(h);var k=e[0];k.id&&a.dA(k);e.find("[id]").each(function(){a.dA(this)});c.hide().attr({"aria-hidden":"true"});c=g.uniqueId().attr("id");e=h.attr("aria-controls");k=f(this);k.hasClass("oj-disabled")&&(h.addClass("oj-disabled").attr("aria-disabled","true"),g.removeAttr("href"));
e&&h.data("oj-tabs-aria-controls",e);h.attr({"aria-controls":a.pC(k),"aria-labelledby":c});a.Sc=a.Sc.add(k);k.attr("aria-labelledby",c)});"vertical"==this.options.orientation&&(a.Uf.addClass("oj-tabs-nav-root"),window.setTimeout(function(){if(a&&a.ka){var c=0;a.Fb.addClass("oj-selected").each(function(){var a=f(this);c=Math.max(c,a.outerWidth())}).removeClass("oj-selected");a.ka.addClass("oj-selected");a.Fb.css({width:c+"px"});var e=a.Uf.outerWidth(!0),g=a.Uf.outerHeight(!0),h="rtl"==a.Ec(),k=h?a.element.css("padding-right"):
a.element.css("padding-left"),k=parseInt(k,10);h?a.Sc.css({"margin-right":e-1+k+"px","min-height":g+"px"}):a.Sc.css({"margin-left":e-1+k+"px","min-height":g+"px"})}},0));this.Sc.addClass("oj-tabs-panel").attr("role","tabpanel")},Gj:function(){var a={keydown:this.HT},c=this.options.selectOn;if(c){var e=this;f.each(c.split(" "),function(c,d){a[d]=e.EB})}c=this.Fb.not(".oj-disabled");this._on(c,a);this._on(this.Sc,{keydown:this.LR});if(this.options.removable){var g={click:this.VE};this._on(c.find(".oj-tabs-close-icon"),
g)}this._focusable(c);this._hoverable(c);this.ot(c)},Ln:function(){var a=this.Fb.not(".oj-disabled");this._off(a);this._off(this.Sc)},EB:function(a){var c=this.options,e=this.ka,g=f(a.currentTarget).closest("li"),h=e&&g[0]===e[0],k=this.Yh(g),e=e&&e.length?this.Yh(e):f(),l={fromTab:e,toTab:k};a.preventDefault();g.hasClass("oj-disabled")||this.by||h||e&&e.length&&!1===this._trigger("beforeDeselect",a,l)||!1===this._trigger("beforeSelect",a,l)||(c.selected=this.Xm(g),this.ka=g,k.addClass("oj-tabs-selected"),
e.removeClass("oj-tabs-selected"),l.fromTab.length||l.toTab.length||f.error("ojTabs: Mismatching fragment identifier."),this.NT(a,l))},NT:function(a,c){var e=c.toTab,g=c.fromTab,h,k;c&&(g&&(h=g.attr("id")),e&&(k=e.attr("id")));this.by=!0;var l=this.Hk(h).removeClass("oj-selected");g.hide();this.Hk(k).addClass("oj-selected");"horizontal"==this.options.orientation&&0<this.Fb.length&&(0==this.vj(k)?this.element.addClass("oj-first-child-selected"):this.element.removeClass("oj-first-child-selected"));
e.show();this.by=!1;void 0!==h&&this._trigger("deselect",a,c);this._trigger("select",a,c);this.Jf("selected",this.Xm(null,g,h),this.Xm(null,e,k),a?!0:!1);g.attr({"aria-expanded":"false","aria-hidden":"true"});l.attr("aria-selected","false");e.length&&g.length?l.attr("tabIndex","-1"):e.length&&this.Fb.filter(function(){return"0"===f(this).attr("tabIndex")}).attr("tabIndex","-1");e.attr({"aria-expanded":"true","aria-hidden":"false"});this.Hk(k).attr({"aria-selected":"true",tabIndex:"0"})},sp:function(a){void 0!==
a&&(a=this.Hk(a),this.ka&&a[0]===this.ka[0]||(a=a.find(".oj-tabs-anchor")[0],this.EB({target:a,currentTarget:a,preventDefault:f.noop})))},ZM:function(){if(this.options.removable&&"horizontal"==this.options.orientation){var a=this.N("removeCueText");this.Fb.not(".oj-disabled").each(function(c){var e=f(this).find("\x3e :first-child");e.addClass("oj-removable");c="ojtabs-id_rm_"+c;f(this).attr("aria-describedby",c);f("\x3ca href\x3d'#'\x3e").addClass("oj-tabs-icon oj-component-icon oj-clickable-icon oj-tabs-close-icon").attr({id:c,
tabIndex:"-1","aria-label":a,role:"presentation"}).appendTo(e)})}},JN:function(){this.Fb.find("oj-tabs-close-icon").remove()},tB:function(){this.or=!1;this.OC&&(a.fa.Uj(this.element[0],f.proxy(this.ig,this)),this.OC=!1,this.bE=void 0);this.si?(this.si.ojConveyorBelt("destroy"),this.si.remove(),this.ka=this.si=null):this.element.children(".oj-tabs-nav").remove()},_destroy:function(){this.Lp();var a=this.options.orientation;"vertical"==a?this.element.removeClass("oj-tabs oj-component oj-tabs-vertical oj-helper-clearfix"):
this.element.removeClass("oj-tabs oj-component oj-tabs-horizontal oj-first-child-selected");this.tB();this.Sc.each(function(){f(this).removeAttr("tabIndex").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("role").removeClass("oj-active oj-disabled oj-tabs-selected oj-tabs-gid oj-tabs-panel").removeUniqueId().css("display","");"vertical"==a&&f(this).css("margin-left","").css("min-height","");f(this).find("\x3e :first-child").css("display",
"").removeAttr("aria-hidden")})},rT:function(a){a!==this.options.removable&&(this.options.removable=a,this.refresh())},VE:function(a){var c=f(a.currentTarget).closest("li"),e=this.Yh(c),g={tab:e};if(c&&!1!==this._trigger("beforeRemove",a,g)){if(c.hasClass("oj-selected")){var h=this.mC(e.attr("id"));void 0===h?this.ka=this.options.selected=void 0:(this.options.selected=this.Xm(this.Fb[h]),this.tp=this.cn(h))}e.remove();c.remove();this.vr();this.refresh();this.ka&&this.ka.focus();this._trigger("remove",
a,g)}},addTab:function(a){this.element.append(a);this.element.children(".oj-tabs-selected").length||(this.tp=this.pC(a));this.refresh();this.Fb.last()[0].scrollIntoView(!1)},HF:function(){if(this.options.reorderable&&this.options.disabledTabs.length!==this.Fb.length){var a=this;this.Uf.sortable({axis:"horizontal"==a.options.orientation?"x":"y",stop:function(c,e){var f=e.item;a.BB(f,f.prev())}})}else this.Uf.sortable({disabled:!0})},GF:function(a){a||(a=this.options.orientation);if("horizontal"==a)"vertical"==
this.options.orientation&&this.Sc&&(this.element.removeClass("oj-tabs-vertical oj-helper-clearfix"),this.Sc.each(function(){f(this).css("margin-left","").css("min-height","")})),this.element.addClass("oj-tabs oj-component oj-tabs-horizontal");else if("vertical"==a)"horizontal"==this.options.orientation&&this.Sc&&this.element.removeClass("oj-tabs-horizontal"),this.element.addClass("oj-tabs oj-component oj-tabs-vertical oj-helper-clearfix");else return;this.options.orientation=a},XS:function(a){return a?
a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$\x26"):""},Yh:function(a){a=f(a).attr("aria-controls");return this.element.find(this.XS("#"+a))},tq:function(a){return this.Fb.eq(a)},BC:function(){var a=this.Uf.parent();a.hasClass("oj-tabs-conveyor")||(a=this.Uf.wrap("\x3cdiv\x3e").parent().addClass("oj-tabs-conveyor"),a.wrap("\x3cdiv\x3e").parent().addClass("oj-tabs-nav-root").uniqueId().attr("id"));return a},dA:function(a){0>a.id.indexOf("ojtabs-id_")&&f(a).attr("id","ojtabs-id_"+a.id)},getNodeBySubId:function(a){if(null==
a)return this.element?this.element[0]:null;var c=a.subId;a=a.index;switch(c){case "oj-conveyorbelt":return this.si?this.si[0]:null;case "oj-tabs-panel":return this.Sc[a];case "oj-tabs-tab":return this.Fb[a];case "oj-tabs-title":return this.Lo[a];case "oj-tabs-close-icon":return this.tq(a).find("."+c)[0]}return null},CC:function(){return this.element[0].clientWidth},qD:function(){return this.bE>this.CC()},HX:function(){return this.or},AF:function(a){this.or=a},tP:function(){var a=Math.floor(this.CC()/
this.Fb.length);this.options.removable&&(a-=28);return a},qA:function(){if(!this.or){var a=this.tP();this.Lo.each(function(){f(this).css("max-width",""+a+"px").addClass("oj-tabs-title-overflow")});this.AF(!0)}},GS:function(){this.or&&(this.Lo.each(function(){f(this).css("max-width","").removeClass("oj-tabs-title-overflow")}),this.AF(!1))},LX:function(){},ig:function(){this.qD()?this.qA():this.GS()},RQ:function(){return"auto"==this.options.truncation||"progressive"==this.options.truncation},RT:function(){"horizontal"==
this.options.orientation&&0<this.Fb.length&&this.RQ()&&(a.fa.vh(this.element[0],f.proxy(this.ig,this)),this.OC=!0,this.bE=this.BC()[0].scrollWidth,this.qD()&&this.qA())},Jf:function(a,c,e,f){this._trigger("optionChange",f,{option:a,previousValue:c,value:e,optionMetadata:{writeback:f?"shouldWrite":"shouldNotWrite"}})},nh:function(a,c){this.Va.tab="keydown"===a.originalEvent.originalEvent.type?this.ka:f(a.originalEvent.target).closest("li");this.Va.uY=this.Va.tab.attr("id");c.openOptions.position={my:"start top",
at:"start bottom",of:this.Va.tab[0]};if(this.Va.te&&(this.Va.Pl||this.Va.Po)){var e=!this.Va.Lr;this.Va.Pl.hasClass("oj-disabled")!=e&&(e?(this.Va.Pl.addClass("oj-disabled"),this.Va.Po.addClass("oj-disabled")):(this.Va.Pl.removeClass("oj-disabled"),this.Va.Po.removeClass("oj-disabled")),this.Va.ue.ojMenu("refresh"))}},$g:function(a){var d=c[a];a='\x3ca href\x3d"#"\x3e'+this.N(a)+"\x3c/a\x3e";return f("\x3cli id\x3d"+d+"\x3e"+a+"\x3c/li\x3e")},oR:function(a){if(!a||!a.length)return!1;this.Va.Lr=a},
LD:function(a,c){if(!a||!a.length||!this.Va.Lr)return!1;var e=this.Va.Lr;this.Va.Lr=!1;this.BB(e,a,c)},oh:function(a,c){var e=c?c.item.attr("id"):void 0;"ojtabscut"===e?this.oR(this.Va.tab):"ojtabspastebefore"===e?this.LD(this.Va.tab,!0):"ojtabspasteafter"===e&&this.LD(this.Va.tab,!1)},en:function(a){var c,e;a||this.options.contextMenu||(c=this.element.attr("contextmenu"))&&(this.options.contextMenu="#"+c);if(a||this.options.contextMenu){c=a||this.options.contextMenu;e=f.type(c);if("function"==e){try{c=
c()}catch(g){c=null}e=f.type(c)}if("string"===e){if(c=f(c)){c.css("display","none");e=this.Va;if(!e)return;e.ue=c;e.te=!0}this.Va.te&&a&&this.um()}}},um:function(){if(this.Va&&this.Va.te&&this.options.reorderable){var a=this.Va.ue,c=this;a.on("ojselect",f.proxy(this.oh,this));a.on("ojbeforeopen",f.proxy(this.nh,this));var e=!1;a.find("[data-oj-command]").each(function(){if(0===f(this).children("a").length){var a=f(this).attr("data-oj-command").slice(8);f(this).replaceWith(c.$g(a));f(this).addClass("oj-menu-item");
e=!0}});e&&a.ojMenu("refresh");this.Va.Pl=a.find("#ojtabspastebefore");this.Va.Po=a.find("#ojtabspasteafter")}},Lp:function(){var a=this.Va;a&&a.te&&(a.te=!1,a.ue.off("ojselect"),a.ue.off("ojbeforeopen"),a.ue=null)},BB:function(a,c,e){this.jn(this.Fb.index(a))||(a=this.Yh(a),c.length?e?this.Yh(c).before(a):this.Yh(c).after(a):0<this.Sc.length&&this.Sc.first().before(a),this.vr(),this.refresh())},pC:function(a){var c=a.attr("id");c||(c=a.uniqueId().attr("id"),a.addClass("oj-tabs-gid"));return c},Hk:function(a){return this.tq(this.vj(a))},
oC:function(a){if("number"===typeof a){if(0<=a&&a<this.Sc.length)return this.cn(a)}else if("string"===typeof a&&-1!=this.vj(a))return a},cn:function(a){return this.Sc.eq(a).attr("id")},vj:function(a){return"number"===typeof a?a:this.Sc.index(f("#"+a))},Xm:function(a,c,e){if(a||c)return a&&(c=this.Yh(a),e=c.attr("id")),c.hasClass("oj-tabs-gid")?this.vj(e):e},BF:function(a){this.element.children().removeClass("oj-disabled");this.Fb&&f(this.Fb).removeClass("oj-disabled");if(a&&0<a.length)for(var c=this.element.children(),
e=this.si?c.index(this.si)+1:0,g,h=0;h<a.length;h++)g=a[h],"number"===typeof g&&0<=g&&e+g<c.length?f(c[e+g]).addClass("oj-disabled"):"string"===typeof g&&this.element.find("#"+g).addClass("oj-disabled")},vr:function(){var a=[],c=this;this.Uf.children(".oj-disabled").each(function(){a.push(c.Xm(f(this)))});this.options.disabledTabs=a}})})()});
//# sourceMappingURL=oj-modular.map